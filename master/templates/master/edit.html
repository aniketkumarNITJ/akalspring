{% extends "./base.html" %}

{% block style %}
<style>
    td {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    table {
        table-layout: fixed;
    }

    ul {
        display: flex;
        list-style: none;
    }

    .modal-body {
        max-height: calc(90vh - 200px);
        overflow-y: auto;
    }
</style>

<script>
    let totalProds = 0;

    function parser(str) {
        while (str.slice(-1) == '1' || str.slice(-1) == '2' || str.slice(-1) == '3' || str.slice(-1) == '4' || str
            .slice(-1) == '5' || str.slice(-1) == '6' || str.slice(-1) == '7' || str.slice(-1) == '8' || str.slice(-
                1) == '9' || str.slice(-1) == '0' || str.slice(-1) == ' ') {
            str = str.slice(0, -1);
        }

        return str;
    }
</script>
{% endblock %}

{% block content %}

<div class="page-content bg-white">

    <!-- inner page banner END -->
    <!-- contact area -->


    <div class="section-full bg-white content-inner">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="sort-title clearfix text-center">
                        <h4>EDIT BILL WITH INVOICE {{bill.invoice}}</h4>
                    </div>
                    <div class="section-content box-sort-in button-example p-t10 p-b30 ">
                        <div id="addNewBill" class="tab-pane">
                            <form id="login" class="tab-pane active" method="POST"
                                onsubmit="event.preventDefault();billCreation(this)" action="saveEdit">
                                {% csrf_token %}
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th scope="col">Particulars</th>
                                            <th scope="col">Data</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Date Of Billing</td>
                                            <td>
                                                <div class="col-lg-6 col-md-6">
                                                    <div class="form-group">
                                                        <div class="input-group">
                                                            <input name="billDate" type="date" class="form-control"
                                                                placeholder="Date Of Billing" required
                                                                value="{{bill.billDate}}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Other Reference(s)</td>
                                            <td>
                                                <div class="col-lg-6 col-md-6">
                                                    <div class="form-group">
                                                        <div class="input-group">
                                                            <input name="otherReferences" type="text"
                                                                class="form-control" placeholder="Other Reference(s)"
                                                                value="{{bill.otherReferences}}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Bill Of Lading No</td>
                                            <td>
                                                <div class="col-lg-6 col-md-6">
                                                    <div class="form-group">
                                                        <div class="input-group">
                                                            <input name="billOfLadingNo" type="text"
                                                                class="form-control" placeholder="Lading No"
                                                                value="{{bill.billOfLadingNo}}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Lading Date</td>
                                            <td>
                                                <div class="col-lg-6 col-md-6">
                                                    <div class="form-group">
                                                        <div class="input-group">
                                                            <input name="ladingDate" type="date" class="form-control"
                                                                placeholder="Lading Date" value="{{bill.ladingDate}}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>GR No</td>
                                            <td>
                                                <div class="col-lg-6 col-md-6">
                                                    <div class="form-group">
                                                        <div class="input-group">
                                                            <input name="grNo" type="text" class="form-control"
                                                                placeholder="GR No" value="{{bill.grNo}}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Consigne</td>
                                            <td style="overflow: visible;">
                                                <div class="form-group">
                                                    <div class="input-group">
                                                        <div class="col-lg-6 col-md-6">
                                                            <select name="customerId" type="text">
                                                                <option selected value="{{bill.customerId}}">
                                                                    {{bill.customerId}}
                                                                </option>
                                                                {% for company in companies %}
                                                                <option value="{{company}}">{{company}}</option>
                                                                {% endfor %}
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        
                                        <tr>
                                            <td>Other Than Consigne</td>
                                            <td style="overflow: visible;">
                                                <div class="form-group">
                                                    <div class="input-group">
                                                        <div class="col-lg-6 col-md-6">
                                                            <select name="otherThanConsigne" type="text">
                                                                <option value="{{bill.otherThanConsigne}}" selected>{{bill.otherThanConsigne}}</option>
                                                                {% for company in companies %}
                                                                <option value="{{company}}">{{company}}</option>
                                                                {% endfor %}
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr>
                                            <td>Term Of Payment</td>
                                            <td>
                                                <div class="col-lg-6 col-md-6">
                                                    <div class="form-group">
                                                        <div class="input-group">
                                                            <input name="termsOfPayment" type="text"
                                                                class="form-control" placeholder="Term Of Payment"
                                                                value="{{bill.termsOfPayment}}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Nature Of Contract</td>
                                            <td>
                                                <div class="col-lg-6 col-md-6">
                                                    <div class="form-group">
                                                        <div class="input-group">
                                                            <input name="natureOfContract" type="text"
                                                                class="form-control" placeholder="Nature Of Contract"
                                                                value="{{bill.natureOfContract}}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Pre-Carriage</td>
                                            <td>
                                                <div class="col-lg-6 col-md-6">
                                                    <div class="form-group">
                                                        <div class="input-group">
                                                            <input name="preCarriage" type="text" class="form-control"
                                                                placeholder="Pre-Carriage" value="{{bill.preCarriage}}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Vessel / Flight No</td>
                                            <td>
                                                <div class="col-lg-6 col-md-6">
                                                    <div class="form-group">
                                                        <div class="input-group">
                                                            <input name="vesselFlightNo" type="text"
                                                                class="form-control" placeholder="Vessel / Flight No"
                                                                value="{{bill.vesselFlightNo}}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Port Of Loading</td>
                                            <td>
                                                <div class="col-lg-6 col-md-6">
                                                    <div class="form-group">
                                                        <div class="input-group">
                                                            <input name="portOfLoading" type="text" class="form-control"
                                                                placeholder="Port Of Loading"
                                                                value="{{bill.portOfLoading}}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Port Of Discharge</td>
                                            <td>
                                                <div class="col-lg-6 col-md-6">
                                                    <div class="form-group">
                                                        <div class="input-group">
                                                            <input name="portOfDischarge" type="text"
                                                                class="form-control" placeholder="Port Of Discharge"
                                                                value="{{bill.portOfDischarge}}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Final Destination</td>
                                            <td>
                                                <div class="col-lg-6 col-md-6">
                                                    <div class="form-group">
                                                        <div class="input-group">
                                                            <input name="finalDestination" type="text"
                                                                class="form-control" placeholder="Final Destination"
                                                                value="{{bill.finalDestination}}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Freight Charges</td>
                                            <td>
                                                <div class="col-lg-6 col-md-6">
                                                    <div class="form-group">
                                                        <div class="input-group">
                                                            <input name="freightCharges" type="number" required
                                                                class="form-control" placeholder="Freight Charges"
                                                                min="0" step="0.01" value="{{bill.freightCharges}}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>Currency</td>
                                            <td style="overflow: visible;">
                                                <div class="col-lg-6 col-md-6">
                                                    <div class="form-group">
                                                        <div class="input-group">
                                                            <select name="currency" type="text" class="form-control">
                                                                <option selected value="{{bill.currency}}">
                                                                    {{bill.currency}}
                                                                </option>
                                                                <option
                                                                        value="America (United States) Dollars - USD">
                                                                        America (United States) Dollars – USD
                                                                    </option>
                                                                    <option value="Euro - EUR">Euro – EUR</option>
                                                                    <option value="Russia Rubles - RUB">Russia
                                                                        Rubles – RUB</option>
                                                                    <option value="Australia Dollars - AUD">
                                                                        Australia Dollars – AUD</option>
                                                                    <option value="United Kingdom Pounds - GBP">
                                                                        United Kingdom Pounds – GBP</option>
                                                                    <option value="Afghanistan Afghanis - AFN">
                                                                        Afghanistan Afghanis – AFN</option>
                                                                    <option value="Albania Leke - ALL">Albania Leke
                                                                        – ALL</option>
                                                                    <option value="Algeria Dinars - DZD">Algeria
                                                                        Dinars – DZD</option>
                                                                    <option value="Argentina Pesos - ARS">Argentina
                                                                        Pesos – ARS</option>
                                                                    <option value="Austria Schillings - ATS">Austria
                                                                        Schillings – ATS</OPTION>

                                                                    <option value="Bahamas Dollars - BSD">Bahamas
                                                                        Dollars – BSD</option>
                                                                    <option value="Bahrain Dinars - BHD">Bahrain
                                                                        Dinars – BHD</option>
                                                                    <option value="Bangladesh Taka - BDT">Bangladesh
                                                                        Taka – BDT</option>
                                                                    <option value="Barbados Dollars - BBD">Barbados
                                                                        Dollars – BBD</option>
                                                                    <option value="Belgium Francs - BEF">Belgium
                                                                        Francs – BEF</OPTION>
                                                                    <option value="Bermuda Dollars - BMD">Bermuda
                                                                        Dollars – BMD</option>

                                                                    <option value="Brazil Reais - BRL">Brazil Reais
                                                                        – BRL</option>
                                                                    <option value="Bulgaria Leva - BGN">Bulgaria
                                                                        Leva – BGN</option>
                                                                    <option value="Canada Dollars - CAD">Canada
                                                                        Dollars – CAD</option>
                                                                    <option value="CFA BCEAO Francs - XOF">CFA BCEAO
                                                                        Francs – XOF</option>
                                                                    <option value="CFA BEAC Francs - XAF">CFA BEAC
                                                                        Francs – XAF</option>
                                                                    <option value="Chile Pesos - CLP">Chile Pesos –
                                                                        CLP</option>

                                                                    <option value="China Yuan Renminbi - CNY">China
                                                                        Yuan Renminbi – CNY</option>
                                                                    <option value="RMB (China Yuan Renminbi) - CNY">
                                                                        RMB (China Yuan Renminbi) – CNY</option>
                                                                    <option value="Colombia Pesos - COP">Colombia
                                                                        Pesos – COP</option>
                                                                    <option value="CFP Francs - XPF">CFP Francs –
                                                                        XPF</option>
                                                                    <option value="Costa Rica Colones - CRC">Costa
                                                                        Rica Colones – CRC</option>
                                                                    <option value="Croatia Kuna - HRK">Croatia Kuna
                                                                        – HRK</option>

                                                                    <option value="Cyprus Pounds - CYP">Cyprus
                                                                        Pounds – CYP</option>
                                                                    <option value="Czech Republic Koruny - CZK">
                                                                        Czech Republic Koruny – CZK</option>
                                                                    <option value="Denmark Kroner - DKK">Denmark
                                                                        Kroner – DKK</option>
                                                                    <option value="Deutsche (Germany) Marks - DEM">
                                                                        Deutsche (Germany) Marks – DEM</OPTION>
                                                                    <option value="Dominican Republic Pesos - DOP">
                                                                        Dominican Republic Pesos – DOP</option>
                                                                    <option value="Dutch (Netherlands) Guilders - NLG">
                                                                        Dutch (Netherlands) Guilders – NLG</OPTION>

                                                                    <option value="Eastern Caribbean Dollars - XCD">
                                                                        Eastern Caribbean Dollars – XCD</option>
                                                                    <option value="Egypt Pounds - EGP">Egypt Pounds
                                                                        – EGP</option>
                                                                    <option value="Estonia Krooni - EEK">Estonia
                                                                        Krooni – EEK</option>
                                                                    <option value="Fiji Dollars - FJD">Fiji Dollars
                                                                        – FJD</option>
                                                                    <option value="Finland Markkaa - FIM">Finland
                                                                        Markkaa – FIM</OPTION>

                                                                    <option value="France Francs - FRF*">France
                                                                        Francs – FRF*</OPTION>
                                                                    <option value="Germany Deutsche Marks - DEM">
                                                                        Germany Deutsche Marks – DEM</OPTION>
                                                                    <option value="Gold Ounces - XAU">Gold Ounces –
                                                                        XAU</option>
                                                                    <option value="Greece Drachmae - GRD">Greece
                                                                        Drachmae – GRD</OPTION>
                                                                    <option value="Guatemalan Quetzal - GTQ">
                                                                        Guatemalan Quetzal – GTQ</OPTION>
                                                                    <option
                                                                        value="Holland (Netherlands) Guilders - NLG">
                                                                        Holland (Netherlands) Guilders – NLG
                                                                    </OPTION>
                                                                    <option value="Hong Kong Dollars - HKD">Hong
                                                                        Kong Dollars – HKD</option>

                                                                    <option value="Hungary Forint - HUF">Hungary
                                                                        Forint – HUF</option>
                                                                    <option value="Iceland Kronur - ISK">Iceland
                                                                        Kronur – ISK</option>
                                                                    <option value="IMF Special Drawing Right - XDR">
                                                                        IMF Special Drawing Right – XDR</option>
                                                                    <option value="India Rupees - INR">India Rupees
                                                                        – INR</option>
                                                                    <option value="Indonesia Rupiahs - IDR">
                                                                        Indonesia Rupiahs – IDR</option>
                                                                    <option value="Iran Rials - IRR">Iran Rials –
                                                                        IRR</option>

                                                                    <option value="Iraq Dinars - IQD">Iraq Dinars –
                                                                        IQD</option>
                                                                    <option value="Ireland Pounds - IEP*">Ireland
                                                                        Pounds – IEP*</OPTION>
                                                                    <option value="Israel New Shekels - ILS">Israel
                                                                        New Shekels – ILS</option>
                                                                    <option value="Italy Lire - ITL*">Italy Lire –
                                                                        ITL*</OPTION>
                                                                    <option value="Jamaica Dollars - JMD">Jamaica
                                                                        Dollars – JMD</option>
                                                                    <option value="Japan Yen - JPY">Japan Yen – JPY
                                                                    </option>

                                                                    <option value="Jordan Dinars - JOD">Jordan
                                                                        Dinars – JOD</option>
                                                                    <option value="Kenya Shillings - KES">Kenya
                                                                        Shillings – KES</option>
                                                                    <option value="Korea (South) Won - KRW">Korea
                                                                        (South) Won – KRW</option>
                                                                    <option value="Kuwait Dinars - KWD">Kuwait
                                                                        Dinars – KWD</option>
                                                                    <option value="Lebanon Pounds - LBP">Lebanon
                                                                        Pounds – LBP</option>
                                                                    <option value="Luxembourg Francs - LUF">
                                                                        Luxembourg Francs – LUF</OPTION>

                                                                    <option value="Malaysia Ringgits - MYR">Malaysia
                                                                        Ringgits – MYR</option>
                                                                    <option value="Malta Liri - MTL">Malta Liri –
                                                                        MTL</option>
                                                                    <option value="Mauritius Rupees - MUR">Mauritius
                                                                        Rupees – MUR</option>
                                                                    <option value="Mexico Pesos - MXN">Mexico Pesos
                                                                        – MXN</option>
                                                                    <option value="Morocco Dirhams - MAD">Morocco
                                                                        Dirhams – MAD</option>
                                                                    <option value="Netherlands Guilders - NLG">
                                                                        Netherlands Guilders – NLG</OPTION>

                                                                    <option value="New Zealand Dollars - NZD">New
                                                                        Zealand Dollars – NZD</option>
                                                                    <option value="Norway Kroner - NOK">Norway
                                                                        Kroner – NOK</option>
                                                                    <option value="Oman Rials - OMR">Oman Rials –
                                                                        OMR</option>
                                                                    <option value="Pakistan Rupees - PKR">Pakistan
                                                                        Rupees – PKR</option>
                                                                    <option value="Palladium Ounces - XPD">Palladium
                                                                        Ounces – XPD</option>
                                                                    <option value="Peru Nuevos Soles - PEN">Peru
                                                                        Nuevos Soles – PEN</option>

                                                                    <option value="Philippines Pesos - PHP">
                                                                        Philippines Pesos – PHP</option>
                                                                    <option value="Platinum Ounces - XPT">Platinum
                                                                        Ounces – XPT</option>
                                                                    <option value="Poland Zlotych - PLN">Poland
                                                                        Zlotych – PLN</option>
                                                                    <option value="Portugal Escudos - PTE">Portugal
                                                                        Escudos – PTE</OPTION>
                                                                    <option value="Qatar Riyals - QAR">Qatar Riyals
                                                                        – QAR</option>
                                                                    <option value="Romania New Lei - RON">Romania
                                                                        New Lei – RON</option>

                                                                    <option value="Romania Lei - ROL">Romania Lei –
                                                                        ROL</option>
                                                                    <option value="Saudi Arabia Riyals - SAR">Saudi
                                                                        Arabia Riyals – SAR</option>
                                                                    <option value="Silver Ounces - XAG">Silver
                                                                        Ounces – XAG</option>
                                                                    <option value="Singapore Dollars - SGD">
                                                                        Singapore Dollars – SGD</option>
                                                                    <option value="Slovakia Koruny - SKK">Slovakia
                                                                        Koruny – SKK</option>

                                                                    <option value="Slovenia Tolars - SIT">Slovenia
                                                                        Tolars – SIT</option>
                                                                    <option value="South Africa Rand - ZAR">South
                                                                        Africa Rand – ZAR</option>
                                                                    <option value="South Korea Won - KRW">South
                                                                        Korea Won – KRW</option>
                                                                    <option value="Spain Pesetas - ESP">Spain
                                                                        Pesetas – ESP</OPTION>
                                                                    <option value="Special Drawing Rights (IMF) - XDR">
                                                                        Special Drawing Rights (IMF) – XDR</option>
                                                                    <option value="Sri Lanka Rupees - LKR">Sri Lanka
                                                                        Rupees – LKR</option>

                                                                    <option value="Sudan Dinars - SDD">Sudan Dinars
                                                                        – SDD</option>
                                                                    <option value="Sweden Kronor - SEK">Sweden
                                                                        Kronor – SEK</option>
                                                                    <option value="Switzerland Francs - CHF">
                                                                        Switzerland Francs – CHF</option>
                                                                    <option value="Taiwan New Dollars - TWD">Taiwan
                                                                        New Dollars – TWD</option>
                                                                    <option value="Thailand Baht - THB">Thailand
                                                                        Baht – THB</option>
                                                                    <option value="Trinidad and Tobago Dollars - TTD">
                                                                        Trinidad and Tobago Dollars – TTD</option>

                                                                    <option value="Tunisia Dinars - TND">Tunisia
                                                                        Dinars – TND</option>
                                                                    <option value="Turkey New Lira - TRY">Turkey New
                                                                        Lira – TRY</option>
                                                                    <option value="United Arab Emirates Dirhams - AED">
                                                                        United Arab Emirates Dirhams – AED</option>
                                                                    <option value="United States Dollars - USD">
                                                                        United States Dollars – USD</option>
                                                                    <option value="Venezuela Bolivares - VEB">
                                                                        Venezuela Bolivares – VEB</option>

                                                                    <option value="Vietnam Dong - VND">Vietnam Dong
                                                                        – VND</option>
                                                                    <option value="Zambia Kwacha - ZMK">Zambia
                                                                        Kwacha – ZMK</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>

                                        <tr>
                                            <td>Discount / Advance</td>
                                            <td>
                                                <div class="col-lg-6 col-md-6">
                                                    <div class="form-group">
                                                        <div class="input-group">
                                                            <input name="discount" type="number"
                                                                class="form-control" placeholder="Discount In Same Currency" value="{{bill.discount}}">
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                                <div id="productList">
                                    {%for product in bill.products%}

                                    <script>
                                        totalProds++;

                                        document.write(`
                                    <div class="row" id="row{{forloop.counter}}">
                                        <div class="col-lg-2 col-md-2">
                                                <div class="form-group">
                                                    <label for="">Sr. No</label>
                                                    <div class="input-group">
                                                        <div>` + totalProds + `</div>
                                                    </div>
                                                </div>
                                            </div>
                                        <div class="col-lg-2 col-md-2">
                                            <div class="form-group">
                                                <label for="">Product</label>
                                                <div class="input-group">
                                                    <select name="productId` + totalProds + `" type="text"
                                                        class="form-control">
                                                        <option selected value='{"name" : "{{product.name}}", "hsnCode" : "{{product.hsnCode}}", "weight" : "{{product.weight}}"}'>
                                                            {{product.name}}
                                                        </option>
                                                        {% for prod in products %}
                                                        <option
                                                                value='{"name" : "{{prod.product_name}}", "hsnCode" : "{{prod.hsnCode}}", "weight" : "{{prod.weight}}"}'>
                                                                {{prod.product_name}}
                                                            </option>
                                                        {% endfor %}
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-2 col-md-2">
                                            <div class="form-group">
                                                <label for="">Cost Per Pce</label>
                                                <div class="input-group">
                                                    <input name="cpp` + totalProds + `" type="number" required
                                                        class="form-control" placeholder="Cost per piece" min="0"
                                                        step="0.01" value="{{product.cpp}}">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-2 col-md-2">
                                            <div class="form-group">
                                                <label for="">Quantity</label>
                                                <div class="input-group">
                                                    <input name="qty` + totalProds + `" type="number" required
                                                        class="form-control" placeholder="Quantity" min="1" value="{{product.qty}}">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-2 col-md-2">
                                            <div class="form-group">
                                                <label for="">Box Weight</label>
                                                <div class="input-group">
                                                    <input name="boxWt` + totalProds + `" type="number" required
                                                        class="form-control" placeholder="Box Weight" min="0"
                                                        step="0.001" value="{{product.boxWt}}">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-2 col-md-2">
                                            <div class="form-group">
                                                <label for="">Box Type</label>
                                                <div class="input-group">
                                                    <select name="boxType` + totalProds + `" type="text" class="form-control">
                                                        <option value="` + parser(`{{product.boxType}}`) +
                                            `" selected>` + parser(`{{product.boxType}}`) + `</option>
                                                        <option value="Steel Pallet">Steel Pallets</option>
                                                        <option value="Wooden Pallet">Wooden Pallets</option>
                                                        <option value="Wooden Box">Wooden Box</option>
                                                        </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>`
                                        )
                                    </script>
                                    {%endfor%}
                                </div>

                                <div class="container">
                                    <div class="col-lg-12 post card-container">
                                        <div class="section-content box-sort-in  button-example m-b30"
                                            style="margin-left: 42%;">
                                            <button class="site-button green radius-xl  m-r15" type="button"
                                                onclick="addNewProdList()">Add <i
                                                    class="fa fa-plus-circle bg-green text-white"></i></button>
                                            <button class="site-button red radius-xl  m-r15" type="button"
                                                onclick="removeProductList()">Rem <i
                                                    class="fa fa-minus-circle bg-red text-white"></i></button>
                                        </div>
                                    </div>
                                </div>

                                <div class="text-center m-t15">
                                    <button class="site-button radius-no outline outline-2">
                                        Save Changes</button>
                                </div>

                                <input type="number" name="totalProds" id="totalProds" style="display: none;">
                                <input type="number" name="id" id="billId" style="display: none;">
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- </div> -->
</div>
{% endblock content %}


{% block script %}
<script>
    function addNewProdList() {
        let prodType = document.getElementsByName('productId' + totalProds)[0].value;
        prodParsed = JSON.parse(prodType)
        name = prodParsed["name"]
        let prodCostPerPce = document.getElementsByName('cpp' + totalProds)[0].value;
        let prodQty = document.getElementsByName('qty' + totalProds)[0].value;
        let boxWt = document.getElementsByName('boxWt' + totalProds)[0].value;
        let boxType = document.getElementsByName('boxType' + totalProds)[0].value;

        totalProds++;
        const div = document.createElement('div');
        div.className = "row";
        div.id = "row"+totalProds
        div.innerHTML = `
                                                <div class="col-lg-2 col-md-2">
                                                <div class="form-group">
                                                    <label for="">Sr. No</label>
                                                    <div class="input-group">
                                                        <div>` + totalProds + `</div>
                                                    </div>
                                                </div>
                                            </div><div class="col-lg-2 col-md-2">
                                                <div class="form-group">
                                                    <label for="">Product</label>
                                                    <div class="input-group">
                                                        <select name="productId` + totalProds + `" type="text"
                                                            class="form-control">
                                                            <option selected value='` + prodType + `'>` + name + `
                                                            </option>
                                                            {% for product in products %}
                                                            <option
                                                                value='{"name" : "{{product.product_name}}", "hsnCode" : "{{product.hsnCode}}", "weight" : "{{product.weight}}"}'>
                                                                {{product.product_name}}
                                                            </option>
                                                            {% endfor %}
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-2 col-md-2">
                                                <div class="form-group">
                                                    <label for="">Cost Per Pce</label>
                                                    <div class="input-group">
                                                        <input name="cpp` + totalProds + `" type="number" required class="form-control"
                                                            placeholder="Cost per piece" min="0" step="0.01" value="` +
            prodCostPerPce + `">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-2 col-md-2">
                                                <div class="form-group">
                                                    <label for="">Quantity</label>
                                                    <div class="input-group">
                                                        <input name="qty` + totalProds + `" type="number" required class="form-control"
                                                            placeholder="Quantity" min="1" value="` + prodQty + `">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-2 col-md-2">
                                                <div class="form-group">
                                                    <label for="">Box Weight</label>
                                                    <div class="input-group">
                                                        <input name="boxWt` + totalProds + `" type="number" required class="form-control"
                                                            placeholder="Box Weight"  min="0" step="0.001" value="` +
            boxWt + `">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-2 col-md-2">
                                                <div class="form-group">
                                                    <label for="">Box Type</label>
                                                    <div class="input-group">
                                                        <select name="boxType` + totalProds + `" type="text" class="form-control">
                                                        <option value="Wooden Box" selected value="` + boxType + `">` +
            boxType + `</option>
                                                        <option value="Wooden Box">Wooden Box</option>
                                                        <option value="Wooden Pallet">Wooden Pallets</option>
                                                        <option value="Steel Pallet">Steel Pallet</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>`;
        document.getElementById('productList').appendChild(div);
    }

    function removeProductList() {
        if (totalProds == 1) {
            alert("You Have To Fill Atleast One Product Data");
            return;
        }

        var list = document.getElementById("row" + totalProds);
        list.remove();
        totalProds--;
    }

    function billCreation(e) {
        document.getElementById("totalProds").value = totalProds;
        document.getElementById("billId").value = `{{bill.id}}`;
        e.submit();
    }
</script>
{% endblock %}